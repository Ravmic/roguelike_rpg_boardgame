!function(){"use strict";class t{constructor(t=1,e=5){this.playersArray=[],this.players=t,this.lives=e,this.generatePlayers(),this.createPlayersEl(),this.createPlayerStats()}generatePlayers(){for(let t=0;this.players>t;t++){const e={nr:t,lives:parseInt(this.lives),position:0,currentArea:"start",revive:!1,potions:["hp"]};this.playersArray.push(e)}}createPlayersEl(){const t=document.querySelector(".start");this.playersArray.forEach(((e,s)=>{const i=document.createElement("div");i.classList.add("player"),i.classList.add(`player${s}`),i.setAttribute("player-number",s),i.innerHTML=`<p>${s+1}</p>`,t.appendChild(i)}))}createPlayerStats(){const t=document.querySelector(".stats__players-stats");this.playersArray.forEach(((e,s)=>{const i=document.createElement("div");i.classList.add("player-stats"),i.innerHTML=`\n        <h2 class="player-stats__title player-stats__title--main">Player ${s+1} <i\n            class="player-stats__animation fa-solid fa-caret-down player${s}">\n            <p></p>\n        </i>\n        <i class="player-stats__animation fa-solid fa-caret-up player${s}">\n            <p></p>\n        </i>\n        </h2>\n     <div class="player-stats__life player-stats--flex">\n        <p class="player-stats__title">Life:</p>\n        <div class="player-stats__bar">\n            <p class="player-stats__bar-stat player${s}">${this.lives}/${this.lives}</p>\n            <div class="player-stats__bar-fill player${s}"></div>\n        </div>\n     </div>\n    <div class="player-stats__revive player-stats--flex">\n        <p class="player-stats__title">Has relic:</p>\n        <p class="player-stats__revive  player${s}">${this.playersArray[s].revive?"yes":"no"}</p>\n    </div>`;const a=document.createElement("div"),n=document.createElement("p");a.setAttribute("class",`player-stats__potions player-stats--flex player${s}`),n.textContent="Potions:",n.setAttribute("class","player-stats__title"),a.appendChild(n),this.playersArray[s].potions.forEach((t=>{const e=document.createElement("img");e.setAttribute("class","player-stats__potion"),e.setAttribute("key",s),e.src="images/potion.svg",e.alt="potion",a.appendChild(e)})),i.appendChild(a),t.appendChild(i)}))}}class e{constructor(){this.audioEl=document.querySelector(".hud__music-mp3"),this.controlBarEl=document.querySelector(".hud__music"),this.controlBarHandle=document.querySelector(".volume-control__handle"),this.clickCheck=!1,this.handlePosition=0,this.mainVolume=.2,console.log(this.controlBarEl.offsetLeft),this.diceRoll=new Audio("./sounds/roll-effect.mp3"),this.init()}rollSound(){this.diceRoll.play(),this.diceRoll.volume=this.mainVolume/3}playSong(){this.audioEl.play(),this.audioEl.volume=this.mainVolume}isClicked(){this.clickCheck=!0}isUnclicked(){this.clickCheck=!1}calcOffset(t){const e=t-this.controlBarEl.offsetLeft;e>=this.controlBarEl.offsetWidth?this.handlePosition=this.controlBarEl.offsetWidth:this.handlePosition=e<=0?0:e}mouseMove(t){this.calcOffset(t);const e=this.handlePosition/this.controlBarEl.offsetWidth;this.controlBarHandle.style.left=100*e+"%",this.mainVolume=e,this.audioEl.volume=this.mainVolume}init(){this.controlBarHandle.addEventListener("mousedown",(()=>this.isClicked())),window.addEventListener("mouseup",(()=>this.isUnclicked())),window.addEventListener("mousemove",(t=>{this.clickCheck&&this.mouseMove(t.clientX)})),this.controlBarHandle.addEventListener("touchstart",(()=>this.isClicked())),window.addEventListener("touchend",(()=>this.isUnclicked())),window.addEventListener("touchmove",(t=>{this.clickCheck&&this.mouseMove(t.touches[0].clientX)}))}}class s{constructor(t){this.diceEl=document.querySelector(".dice"),this.diceBtn=document.querySelector(".dice-btn"),this.diceValue=null,this.rollTime=1500,this.diceMaxValue=t,this.rollSound=new e}reset(t){this.diceBtn.classList.remove("active"),this.diceEl.classList.remove("active"),this.diceEl.classList.remove(`roll${t}`)}rollDice=()=>{this.rollSound.rollSound();const t=Math.floor(Math.random()*this.diceMaxValue+1);this.diceValue=t,this.diceAnimation(t)};diceAnimation(t){this.diceEl.classList.add(`roll${t}`),this.diceEl.classList.add("active"),this.diceBtn.classList.add("active"),setTimeout((()=>{this.reset(t)}),this.rollTime)}}class i{constructor(t=null){this.currentPlayer=t,this.healthBarFill=document.querySelector(`.player-stats__bar-fill.player${this.currentPlayer.nr}`),this.healthStat=document.querySelector(`.player-stats__bar-stat.player${this.currentPlayer.nr}`),this.reviveItem=document.querySelector(`.player-stats__revive.player${this.currentPlayer.nr}`),this.potionStack=document.querySelector(`.player-stats__potions.player${this.currentPlayer.nr}`),this.currentPotions=[...document.querySelectorAll(`.player-stats__potions.player${this.currentPlayer.nr} img`)],this.newPotionEl=[]}healthChange(t,e){const s=this.healthBarFill.offsetWidth,i=getComputedStyle(this.healthBarFill).left,a=parseFloat(i)/s*100;this.healthPercent=Math.round(t/e*100),this.currentPlayer.lives+t>=e?(this.healthBarFill.style.left="0%",this.healthStat.textContent=`${e}/${e}`):this.currentPlayer.lives+t<=0?(this.healthBarFill.style.left="-110%",this.healthStat.textContent=`0/${e}`):(this.healthBarFill.style.left=`${a+this.healthPercent}%`,this.healthStat.textContent=`${this.currentPlayer.lives+t}/${e}`)}reviveChange(t=!1){if(1===t){if(this.currentPlayer.revive)return;this.reviveItem.textContent="yes",this.currentPlayer.revive=!0}else!1!==t&&-1!==t||(this.reviveItem.textContent="no",this.currentPlayer.revive=!1)}potionChange(t){if(t>0)for(let e=0;t>e;e++){const t=document.createElement("img");t.setAttribute("class","player-stats__potion"),t.setAttribute("key",this.currentPlayer.nr),t.src="images/potion.svg",t.alt="potion",this.potionStack.appendChild(t),this.currentPlayer.potions.push("hp"),this.newPotionEl.push(t)}else if(t<0){if(this.currentPlayer.potions<=0)return;for(let e=0;-1*t>e;e++)this.currentPotions[e].remove(),this.currentPlayer.potions.splice(0,1)}}}class a{constructor(t){this.luck=t,this.goodEv=["You were walking down the forest and you found healing herbs.","At the end of the road You met friendly druid that heals small wounds.","Your trained eye saw a bag hanging on the tree. Turns out it was small food suplies!","You successfully managed to hunt down a squirrel.","After a long journey, I found something to eat.","A pack of wolves ran away after I killed one of them. Looks like today I have something good to eat"],this.neutralEv=["Its very windy today...","I saw somthing moving in the bush. Turns out it was just a bird","This road is getting very boring.","I see nothing on the horizon.","A large boar come on the road, but I scared him away"],this.badEv=["At the end of the road, I was attacked by bandits.","I tried to hunt a wild boar, but it attacked me","I managed to kill the bear, but he left some scars.","My stomach hurts... I shouldn't eat that mushroom I found earlier...","After I ate those berries I cant see on my left eye!"],this.hp=null,this.randomEv="",this.commentType="",this.randomizeEvent()}randomizeEvent(){if(this.luck<3){const t=Math.floor(Math.random()*this.goodEv.length);this.hp=1,this.randomEv=this.goodEv[t],this.commentType="good"}else if(this.luck>=3&&this.luck<6){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=6){const t=Math.floor(Math.random()*this.badEv.length);this.hp=-1,this.randomEv=this.badEv[t],this.commentType="bad"}}}class n{constructor(t){this.luck=t,this.goodEv=["Oh look! I found a golden coin! Now I'll buy something to eat.","After countering bandits attack, people praised me and gave me food and shelter","People here loved me after I helped them with bears attacking them."],this.neutralEv=["This place looks weird","Nothing to do in this vilage...","This vilage was under bandits attack. Good thing I managed to pass unnoticed","The market is very crowded today.","I talked to a innkeeper but he dosn't have any jobs right now","The locals don't seem very welcoming"],this.badEv=["There were too many bandits! I couldn't defeat them all. I must return...","A group of drunk vilagers attacked me. It wasn't difficult to defeat them, but they left me with a few bruises.","People there definetly don't like strangers. They welcomed me by throwing rocks and bottles at me"," couldn't find a place to sleep. I guess I'll have to rest outside"],this.hp=null,this.randomEv="",this.commentType="",this.randomizeEvent()}randomizeEvent(){if(this.luck<4){const t=Math.floor(Math.random()*this.goodEv.length);this.hp=1,this.randomEv=this.goodEv[t],this.commentType="good"}else if(this.luck>=4&&this.luck<8){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=8){const t=Math.floor(Math.random()*this.badEv.length);this.hp=-2,this.randomEv=this.badEv[t],this.commentType="bad"}}}class r{constructor(t){this.luck=t,this.goodEv=["I saw a backpack swinging on the vine. There is not much inside, but I found cured beef.","I found some healing herbs!","Those leeches wasn't too hard to beat, but there meat taste awful","A dead body appeared before my eyes. It had a bag with some bread"],this.neutralEv=["This place looks weird.","This place smells really bad","I mannaged to sneak through some giant leeches","A swamp golem just saw me, but i ran away from him.","Those vines looks very suspicious. I need to be very careful."],this.badEv=["I was stuck in the swamp when a horde of imps attacked me. I managed to scare them away, but I get injured.","Swamp golem was too strong for me... I needed to run away","I killed all those leeches, but there was too many of them."],this.hp=null,this.randomEv="",this.commentType="",this.randomizeEvent()}randomizeEvent(){if(this.luck<2){const t=Math.floor(Math.random()*this.goodEv.length);this.hp=1,this.randomEv=this.goodEv[t],this.commentType="good"}else if(this.luck>=2&&this.luck<5){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=5){const t=Math.floor(Math.random()*this.badEv.length);this.hp=-2,this.randomEv=this.badEv[t],this.commentType="bad"}}}class o{constructor(t,e){this.currentPlayer=e,this.luck=t,this.vgoodEv=["Cyclops swung his club in my direction, but he missed. I jumped on his head, and while he was trying to throw me off, I stabbed him in the eye. His body dropped dead, and as he lay on the ground, I found a potion in his pocket!"],this.goodEv=["Minotaurs can't match me! After I slain three of them, I found some healing herbs in one of their pockets.","I successfully hunted some deer! I'm in for quite a feast","In the tracts of mountain flora I found a few interesting flowers that can help me now","I was walking through the field, and suddenly I saw an abandoned camp. The fire was still smoldering, and there was some leftover meat roasting."],this.neutralEv=["There was a nice view up there","Lots of rocks, not many life forms...","nothing to do here","I thought I saw a deer in the distance, but it was a rock."],this.badEv=["Usualy I dont have problems fighting minotaurs, but there was too many of them","I was running away from a cyclops, but suddenly it started throwing rocks at me!","I was walking peacefully when suddenly I saw a giant herd of bison running at me! I tried to hide, but one of them trampled me."],this.vbadEv=["I found a cyclops on the way, and I tried to fight him. I didn't realize that there were five of them! I quickly ran away from that place, but while I was running, "+(this.currentPlayer.potions.length>0?"I lost my potion!":"I fell in to the pit!")],this.hp=null,this.potionsValue=0,this.randomEv="",this.commentType="",this.comment="",this.randomizeEvent()}randomizeEvent(){if(this.luck<1){const t=Math.floor(Math.random()*this.vgoodEv.length);this.hp=0,this.randomEv=this.vgoodEv[t],this.commentType="vgood",this.potionsValue=1,this.comment="You just found a "+(this.potionsValue>1?`${this.potionsValue} potions!`:`${this.potionsValue} potion!`)}else if(this.luck>=1&&this.luck<3){const t=Math.floor(Math.random()*this.goodEv.length);this.hp=2,this.randomEv=this.goodEv[t],this.commentType="good"}else if(this.luck>=3&&this.luck<7){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=7&&this.luck<11){const t=Math.floor(Math.random()*this.badEv.length);this.hp=-3,this.randomEv=this.badEv[t],this.commentType="bad"}else if(this.luck>=11){const t=Math.floor(Math.random()*this.vbadEv.length);this.randomEv=this.vbadEv[t],this.commentType="vbad",this.currentPlayer.potions.length>0?(this.potionsValue=-1,this.comment="You lost a potion!"):(this.hp=-4,this.comment=`You lost ${-1*this.hp}hp points!`)}}}class h{constructor(t,e){this.currentPlayer=e,this.luck=t,this.vgoodEv=["After I thrust my sword through the necromancer, he shattered into pieces. "+(this.currentPlayer.revive?"The wind blew them away and nothing was left from him.":"In the shards of his bones, a shiny golden object caught my eye...")],this.neutralEv=["A thick fog obscures the entire view","I cant see anything","It's really cold here","I saw plenty of open graves. Luckly everyone of them is empty","I decapitated few of those seletons, but they keep getting up! I need to run from this place","I have bad feelings about this place..."],this.badEv=["I was fighting a horde of skeleton soldiers, but my sword was doing nothing to them. They fell apart, but suddenly kept getting back up!"," I can't defeat those skeletons. Its like some powerful magic controls them...","I tried to fight back those skeletons, but theres too many of them...","Fighting the giant spider didn't go as I planned. I sliced it in half, but then hundreds of little spiders started coming out of its body."],this.vbadEv=["The necromancer cursed me! I feel like im rotting inside but I can't die..."],this.hp=null,this.revive=null,this.randomEv="",this.commentType="",this.comment="",this.randomizeEvent()}randomizeEvent(){if(this.luck<1){const t=Math.floor(Math.random()*this.vgoodEv.length);this.hp=1,this.randomEv=this.vgoodEv[t],this.currentPlayer.revive?this.commentType="neutral":(this.revive=1,this.comment="You just found a relic!!!",this.commentType="vgood")}else if(this.luck>=1&&this.luck<6){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=6&&this.luck<11){const t=Math.floor(Math.random()*this.badEv.length);this.hp=-3,this.randomEv=this.badEv[t],this.commentType="bad"}else if(this.luck>=11){const t=Math.floor(Math.random()*this.vbadEv.length);this.hp=-1*Math.round(this.currentPlayer.lives/2),this.currentPlayer<=1&&(this.hp=0),this.randomEv=this.vbadEv[t],this.commentType="vbad",this.comment="You lost half of Your current hp points!"}}}class l{constructor(t,e){this.currentPlayer=e,this.luck=t,this.vgoodEv=["I was hiding behind stone pillars while the dragon tried to kill me. After it stopped breathing fire, I ran in its direction and swung my sword through its neck. The beast was dead! I searched its chamber and found a "+(this.potionsValue>1?`${this.potionsValue} potions!`:`${this.potionsValue} potion!`)],this.neutralEv=['"This place smells like sulfur',"I'm really lucky that I didn't find any dragons.","The pounding of its tail is audible from miles away."],this.badEv=["His claws was masive! I barely dodge it, but I couln't hide from the tale","A red wyvern dropped from the cave ceiling right on me. My armor blocked most of the damage, but it gave me some serious burns.","I had a hard time fighting those wyvern. I still feel its teeth piercing my armor.","Suddenly, the walls around me started to break, and lava started leaking through the cracks. I barely escaped the place, but I burned myself badly..."],this.vbadEv=["I couldn't escape... As the dragon saw me, he spit a giant stream of fire in my direction. Hiding in the cave corridor was my only hope..."],this.hp=null,this.revive=null,this.randomEv="",this.commentType="",this.comment="",this.randomizeEvent()}randomizeEvent(){if(this.luck<1){const t=Math.floor(Math.random()*this.vgoodEv.length);this.hp=0,this.randomEv=this.vgoodEv[t],this.commentType="vgood",this.potionsValue=2,this.comment="You just found a "+(this.potionsValue>1?`${this.potionsValue} potions!`:`${this.potionsValue} potion!`)}else if(this.luck>=1&&this.luck<2){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=2&&this.luck<10){const t=Math.floor(Math.random()*this.badEv.length);this.hp=-3,this.randomEv=this.badEv[t],this.commentType="bad"}else if(this.luck>=10){const t=Math.floor(Math.random()*this.vbadEv.length);this.hp=-1*(this.currentPlayer.lives-1),this.randomEv=this.vbadEv[t],this.commentType="vbad",this.comment="You got left with 1hp point"}}}class c{constructor(t,e){this.currentPlayer=e,this.luck=t,this.vgoodEv=["I entered the temple and saw a blinding beam of light striking from the ceiling. Suddenly, an angel came from the sky and reached its hand out to me. "+(this.currentPlayer.revive?" I felt blessed.":" It gave me golden relic.")],this.goodEv=["I met a friendly priest that helped me heal my wounds","I enter the temple and kneel before a holy statue. I have been praying for a long time for strength and luck on my journey.","The gods heard me, brought me relief!"],this.neutralEv=["there's no one here...","This temple is empty","Sadly, this temple was destroyed long time ago..."],this.vbadEv=["I entered the temple and saw a mysterious figure behind the altar. Suddenly, the doors behind me locked, and the figure reached its hand in my direction. I passed out. When I woke up, there was no one there"+(this.currentPlayer.revive?", and I couldn't find my relic!":".")],this.hp=null,this.revive=null,this.randomEv="",this.commentType="",this.comment="",this.randomizeEvent()}randomizeEvent(){if(this.luck<2){const t=Math.floor(Math.random()*this.vgoodEv.length);this.randomEv=this.vgoodEv[t],this.commentType="vgood",this.currentPlayer.revive?(this.hp=4,this.comment=`You have been healed for ${this.hp}hp points!!`):(this.revive=1,this.comment="You just found a relic!!!")}else if(this.luck>=2&&this.luck<5){const t=Math.floor(Math.random()*this.neutralEv.length);this.hp=0,this.randomEv=this.neutralEv[t],this.commentType="neutral"}else if(this.luck>=5&&this.luck<11){const t=Math.floor(Math.random()*this.goodEv.length);this.hp=3,this.randomEv=this.goodEv[t],this.commentType="good"}else if(this.luck>=11){const t=Math.floor(Math.random()*this.vbadEv.length);this.randomEv=this.vbadEv[t],this.commentType="vbad",this.currentPlayer.revive?(this.revive=-1,this.comment="You just lost you relic!"):(this.comment="?????",this.hp=-1)}}}class d{constructor(t,e,s){this.currentPlayer=t,this.currentLandscape=e,this.duelPlayerIndex=s,this.eventEl=document.querySelector(".screen__text"),this.commentEl=document.querySelector(".screen__comment"),this.hpValue=null,this.reviveValue=!1,this.event="",this.eventComment="",this.commentType="",this.potionsValue=0,this.eventRun()}eventRun(){const t=Math.floor(12*Math.random());let e=null;"forest"===this.currentLandscape?e=new a(t):"village"===this.currentLandscape?e=new n(t):"swamp"===this.currentLandscape?e=new r(t):"mountain"===this.currentLandscape?e=new o(t,this.currentPlayer):"graveyard"===this.currentLandscape?e=new h(t,this.currentPlayer):"dragonsCave"===this.currentLandscape?e=new l(t,this.currentPlayer):"temple"===this.currentLandscape?e=new c(t,this.currentPlayer):"rest"===this.currentLandscape?e=this.rest(t):"duel"===this.currentLandscape&&(e=this.duel(t,this.duelPlayerIndex)),this.hpValue=e.hp,this.event=e.randomEv,this.commentType=e.commentType,this.eventComment=e.comment,this.reviveValue=e.revive,this.potionsValue=e.potionsValue,this.defeatedPlayer=e.defPlayer,this.showEvent()}showEvent(){this.eventEl.textContent=this.event,this.commentEl.setAttribute("class",`screen__comment ${this.commentType}`),"vgood"===this.commentType?this.commentEl.textContent=this.eventComment:"good"===this.commentType?this.commentEl.textContent=`You gained ${this.hpValue>0?`${this.hpValue}hp points.`:""}${this.reviveValue?"a relic!":""}`:"neutral"===this.commentType?this.commentEl.textContent="Nothing has happened...":"bad"===this.commentType?this.commentEl.textContent=`You've lost ${-1*this.hpValue}hp points`:"vbad"===this.commentType&&(this.commentEl.textContent=this.eventComment)}rest(t){const e={hp:0,randomEv:"",commentType:""};return t<4?(e.hp=1,e.commentType="good",e.randomEv="The night was quiet, and I slept pretty well."):t>=4&&t<8?(e.hp=0,e.commentType="neutral",e.randomEv="Sudden noises constantly wake me up. I couldn't close my eyes even once."):t>=8&&(e.hp=-1,e.commentType="bad",e.randomEv="What a horrible night! Someone was trying to rob me. I had to fight..."),e}duel(t,e){const s={hp:0,randomEv:"",commentType:"",comment:"",defPlayer:""};return t<5?(s.hp=-2,s.commentType="vgood",s.randomEv="Your opponent was surprised! he didn't stand a chance against you",s.comment="You just win the fight against other player!",s.defPlayer=e):t>=5&&(s.hp=-3,s.commentType="vbad",s.randomEv="Your opponent didn't get caught off guard! Turned out he was stronger.",s.comment="You have been defeated...",s.defPlayer=this.currentPlayer.nr),s}}class u{constructor(t,e,i){this.mapEl=document.querySelectorAll(".gameboard__row--block"),this.playersList=[...t],this.playersEl=document.querySelectorAll(".player"),this.currentPlayerIndex=i,this.currentPlayerOb=this.playersList[this.currentPlayerIndex],this.maxHp=parseInt(e),this.hpValue=0,this.currentPlayerStatEl=document.querySelector(".currentPlayer"),this.currentPlayerStatEl.textContent=this.currentPlayerIndex+1,this.potionEl=document.querySelectorAll(".player-stats__potion"),this.warnEl=document.querySelector(".game__warning"),this.warnBg=document.querySelector(".game__popup-bg"),this.warnWait=document.querySelector(".game__popup-img"),this.warnMessage=document.querySelector(".game__warning-message"),this.popupEl=document.querySelector(".game__warning--popup"),this.popupMsgEl=document.querySelector(".game__warning--popup-message"),this.dice=new s(6),this.moves=null,this.turnFlag=!0,this.init()}mobileWarn(){}displayWarn(t){this.warnMessage.innerHTML=t,this.warnEl.classList.add("active"),this.warnBg.classList.add("active")}loadScreenOn(){this.warnBg.classList.add("active"),this.warnWait.classList.add("active")}loadScreenOff(){this.warnBg.classList.remove("active"),this.warnWait.classList.remove("active")}gameEndPopup(t){this.popupEl.classList.add("active"),this.warnBg.classList.add("active"),this.popupMsgEl.classList.add("endingBoard"),this.popupMsgEl.textContent=t}playerMove(){this.currentPlayerOb.position+=this.moves,this.currentPlayerOb.position>=this.mapEl.length-1?(this.currentPlayerOb.position=this.mapEl.length-1,this.mapEl[this.mapEl.length-1].appendChild(this.playersEl[this.currentPlayerIndex])):this.mapEl[this.currentPlayerOb.position].appendChild(this.playersEl[this.currentPlayerIndex])}restTurn(){this.loadScreenOn(),setTimeout((()=>{const t=new d(this.currentPlayerOb,"rest");if(this.hpValue=t.hpValue,this.hpControl(),this.playersList.filter((t=>""===t)).length>=this.playersList.length)return this.gameEndPopup("Everyone is Dead! YOU LOOSE!");setTimeout((()=>{this.nextTurn(),this.loadScreenOff()}),this.dice.rollTime/2)}),this.dice.rollTime/2)}potionHeal(t){t.target.getAttribute("key")===this.currentPlayerIndex.toFixed()?this.currentPlayerOb.lives>=this.maxHp?this.displayWarn("You have full health"):(this.hpValue=2,this.currentPlayerOb.potions.splice(0,1),this.hpControl(),t.target.remove(),this.nextTurn()):this.displayWarn("Its not your potion!")}hpControl(){if(this.hpValue>0){new i(this.currentPlayerOb).healthChange(this.hpValue,this.maxHp),this.currentPlayerOb.lives+=this.hpValue;const t=document.querySelector(`.fa-caret-up.player${this.currentPlayerIndex}`);t.classList.add("active"),t.innerHTML=`<p>${this.hpValue}</p>`,setTimeout((()=>t.classList.remove("active")),500),this.currentPlayerOb.lives>this.maxHp&&(this.currentPlayerOb.lives=this.maxHp)}else if(this.hpValue<0){const t=new i(this.currentPlayerOb);t.healthChange(this.hpValue,this.maxHp),this.currentPlayerOb.lives+=this.hpValue;const e=document.querySelector(`.fa-caret-down.player${this.currentPlayerIndex}`);if(e.classList.add("active"),e.innerHTML=`<p>${this.hpValue}</p>`,setTimeout((()=>e.classList.remove("active")),500),this.currentPlayerOb.lives<=0){if(this.currentPlayerOb.lives=0,this.currentPlayerOb.revive)return t.reviveChange(),this.hpValue=this.maxHp,this.displayWarn(`Player ${this.currentPlayerIndex+1} has revived!`),this.hpControl();if(this.playersEl[this.currentPlayerIndex].remove(),this.playersList.splice(this.currentPlayerIndex,1,""),!(this.playersList.filter((t=>""===t)).length<this.playersList.length))return;this.displayWarn(`Player ${this.currentPlayerIndex+1} is dead `)}}}nextTurn(){this.currentPlayerIndex++,this.currentPlayerOb=this.playersList[this.currentPlayerIndex],this.currentPlayerStatEl.textContent++,this.currentPlayerIndex>=this.playersList.length&&(this.currentPlayerIndex=0,this.currentPlayerStatEl.textContent=1,this.currentPlayerOb=this.playersList[this.currentPlayerIndex]),""===this.currentPlayerOb&&this.nextTurn()}duelEvents(t){this.popupEl.classList.remove("active"),setTimeout((()=>{if(t.target.getAttribute("player-number")){const e=this.currentPlayerIndex,s=new d(this.currentPlayerOb,"duel",t.target.getAttribute("player-number"));this.hpValue=s.hpValue,this.currentPlayerIndex=parseInt(s.defeatedPlayer),this.currentPlayerOb=this.playersList[this.currentPlayerIndex],this.hpControl(),this.currentPlayerIndex=e,this.currentPlayerOb=this.playersList[this.currentPlayerIndex]}else this.randomEvents(),this.hpControl();setTimeout((()=>{this.nextTurn(),this.loadScreenOff()}),this.dice.rollTime/2)}),this.dice.rollTime/2)}encounterPlayer(){const t=[...this.mapEl[this.currentPlayerOb.position].querySelectorAll("div")],e=t.splice(0,t.length-1);this.popupEl.classList.add("active"),this.popupMsgEl.textContent=`You met other ${e.length>1?"travelers!":"traveler!"} do you want to attack ${e.length>1?"one of them":"him"} or go to location?`;const s=document.createElement("div"),i=[];s.setAttribute("class"," game__warning--popup-btnPanel"),e.forEach((t=>{const e=t.getAttribute("player-number"),a=document.createElement("button");a.setAttribute("player-number",e),a.setAttribute("class"," game__warning--popup-btn popup--duelBtn"),a.textContent=`Attack player ${parseInt(e)+1}`,i.push(a),s.appendChild(a)}));const a=document.createElement("button");a.textContent="Go to location",a.setAttribute("class","game__warning--popup-btn popup--eventBtn"),s.appendChild(a),this.popupMsgEl.appendChild(s),i.forEach((t=>t.addEventListener("click",(t=>this.duelEvents(t))))),a.addEventListener("click",(t=>this.duelEvents(t)))}randomEvents=()=>{const t=this.mapEl[this.currentPlayerOb.position].getAttribute("area");if("win"===t||"start"===t)return;const e=new d(this.currentPlayerOb,t);this.hpValue=e.hpValue;const s=new i(this.currentPlayerOb);e.reviveValue&&s.reviveChange(e.reviveValue),e.potionsValue&&(s.potionChange(e.potionsValue),s.newPotionEl.forEach((t=>t.addEventListener("click",(t=>this.potionHeal(t))))))};startTurn(){this.loadScreenOn(),this.dice.rollDice(),this.moves=this.dice.diceValue,setTimeout((()=>(this.playerMove(),this.currentPlayerOb.position>=this.mapEl.length-1?this.gameEndPopup(`PLAYER ${this.currentPlayerIndex+1} WINS!`):[...this.mapEl[this.currentPlayerOb.position].childNodes].length>2?this.encounterPlayer():(this.randomEvents(),this.hpControl(),this.playersList.filter((t=>""===t)).length>=this.playersList.length?this.gameEndPopup("Everyone is Dead! YOU LOOSE!"):void setTimeout((()=>{this.nextTurn(),this.loadScreenOff()}),this.dice.rollTime/2)))),this.dice.rollTime/2)}newGame(){const t=document.querySelector(".game__warning--popup-btn");document.querySelector(".game__warning--popup-title").textContent="Greetings "+(this.playersList.length>1?"travelers!":"traveler!"),document.querySelector(".game__warning--popup-await").textContent=`An amazing jorney ${this.playersList.length>1?"awaits":"await"} You!`,this.playersList.length>1&&this.displayWarn(`Player nr ${this.currentPlayerIndex+1} starts the game!`),this.warnBg.classList.add("active"),this.popupEl.classList.add("active"),t.addEventListener("click",(()=>{this.popupEl.classList.remove("active"),this.warnBg.classList.remove("active"),t.remove()}))}init(){this.newGame(),document.querySelector(".dice-btn").addEventListener("click",(()=>this.startTurn())),this.potionEl.forEach((t=>t.addEventListener("click",(t=>this.potionHeal(t))))),document.querySelector(".rest-turn__btn").addEventListener("click",(()=>this.restTurn()))}}class m{constructor(t){this.gameboardEl=document.querySelector(".gameboard"),this.mapSize=t,this.currentBlockNr=0,this.rowNumbers=parseInt(this.mapSize/12),this.mapGenerator()}landscapeSelect(t){return t<2?"forest":t<4&&t>=2?"village":t<6&&t>=4?"swamp":t<8&&t>=6?"mountain":t<10&&t>=8?"graveyard":t<11&&t>=9?"dragonsCave":t<=11?"temple":void 0}mapGenerator(){for(let t=0;this.rowNumbers>t;t++){const t=document.createElement("div");t.setAttribute("class","gameboard__row");for(let e=0;12>e;e++){const e=document.createElement("div");e.setAttribute("class","gameboard__row--block"),e.setAttribute("key",this.currentBlockNr);let s="";const i=Math.floor(12*Math.random());s=this.landscapeSelect(i),0===this.currentBlockNr?s="start":this.currentBlockNr===this.mapSize-1&&(s="win"),e.setAttribute("area",s),e.classList.add(s);const a=document.createElement("p");a.textContent=this.currentBlockNr,0===this.currentBlockNr?a.textContent="start":this.currentBlockNr===this.mapSize-1&&(a.textContent="win"),this.currentBlockNr++,e.appendChild(a),t.appendChild(e)}this.gameboardEl.appendChild(t)}}}new class{constructor(){this.playersBtns=document.querySelectorAll(".menu__settings--players .menu__settings-btn"),this.livesBtns=document.querySelectorAll(".menu__settings--lives .menu__settings-btn"),this.sizeBtns=document.querySelectorAll(".menu__settings--mapSize .menu__settings-btn"),this.warnBtn=document.querySelector(".fa-xmark"),this.warnEl=document.querySelector(".game__warning"),this.warnBg=document.querySelector(".game__popup-bg"),this.startGameBtn=document.querySelector(".start"),this.playersSelected=null,this.livesSelected=null,this.sizeSelected=null,this.playersBtns.forEach((t=>t.addEventListener("click",(t=>this.playerSelect(t))))),this.livesBtns.forEach((t=>t.addEventListener("click",(t=>this.livesSelect(t))))),this.sizeBtns.forEach((t=>t.addEventListener("click",(t=>this.mapSizeSelect(t))))),this.warnBtn.addEventListener("click",(()=>this.closeWarn())),this.startGameBtn.addEventListener("click",(()=>this.startGame(this.playersSelected,this.livesSelected,this.sizeSelected)))}closeWarn(){this.warnEl.classList.remove("active"),this.warnBg.classList.remove("active")}mapSizeSelect(t){this.sizeBtns.forEach((t=>t.classList.remove("active"))),t.target.classList.add("active"),this.sizeSelected=t.target.getAttribute("key")}playerSelect(t){this.playersBtns.forEach((t=>t.classList.remove("active"))),t.target.classList.add("active"),this.playersSelected=t.target.getAttribute("key")}livesSelect(t){this.livesBtns.forEach((t=>t.classList.remove("active"))),t.target.classList.add("active"),this.livesSelected=t.target.getAttribute("key")}startGame(s,i,a){if(s&&i&&a){document.querySelector(".game__menu-wrapper").classList.add("active"),(new e).playSong(),new m(a);const n=new t(s,i).playersArray,r=Math.floor(Math.random()*s);new u(n,i,r)}else this.warnEl.classList.add("active"),this.warnBg.classList.add("active")}}}();